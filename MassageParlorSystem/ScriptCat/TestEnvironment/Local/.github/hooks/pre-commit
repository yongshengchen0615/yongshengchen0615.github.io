#!/usr/bin/env bash
set -e

FILE="ReadyEventONLY.js"

# 只在檔案存在時才處理
[ -f "$FILE" ] || exit 0

# 版本策略：用 yyyy.mmdd.HHMM（你也可以改成其它）
VERSION="$(date +'%Y.%m%d.%H%M')"

# 只改 // @version 那行（符合你現在 header 格式）
perl -pi -e 's/^(\s*\/\/\s*@version\s+).*$/$1'"$VERSION"'/m' "$FILE"

# 自動加入 staged，確保這次 commit 會帶著新版本
git add "$FILE"
