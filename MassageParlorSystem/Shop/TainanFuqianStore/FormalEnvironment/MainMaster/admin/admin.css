:root{
  --radius-lg:16px;
  --radius-md:12px;
  --shadow-soft:0 10px 28px rgba(0,0,0,.16);

  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  --sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC","Helvetica Neue", Arial;

  --accent:#38bdf8;
  --success:#16a34a;
  --warning:#f59e0b;
  --danger:#ef4444;
  --muted:#64748b;

  --bg:#020617;
  --bg-page:var(--bg);
  --card:rgba(255,255,255,.03);
  --card2:rgba(0,0,0,.18);
  --border:#1f2937;
  --border-soft:rgba(31,41,55,.6);
  --text:#e5e7eb;
  --text-sub:#9ca3af;
  --input-bg:#020617;

  --accent-soft:rgba(56,189,248,.12);
  --success-soft:rgba(22,163,74,.12);
  --warning-soft:rgba(245,158,11,.12);
  --danger-soft:rgba(239,68,68,.12);

  --focus: 0 0 0 3px rgba(56,189,248,.22);
  --pad: clamp(12px, 2.4vw, 18px);
}

html[data-theme="light"]{
  --bg:#f8fafc;
  --bg-page:var(--bg);
  --card:rgba(0,0,0,.02);
  --card2:rgba(255,255,255,.75);
  --border:#e2e8f0;
  --border-soft:rgba(226,232,240,.75);
  --text:#0f172a;
  --text-sub:#475569;
  --input-bg:#ffffff;
  --shadow-soft:0 10px 28px rgba(2,6,23,.08);

  /* match client light theme soft colors */
  --accent-soft:rgba(56,189,248,.16);
  --success-soft:rgba(22,163,74,.16);
  --warning-soft:rgba(245,158,11,.16);
  --danger-soft:rgba(239,68,68,.16);
}

*{ box-sizing:border-box; word-break: break-word; }
[hidden]{ display:none !important; }
html,body{ height:100%; margin:0; font-family:var(--sans); color:var(--text); background:var(--bg-page); }
.app{ min-height:100%; padding:var(--pad); display:flex; justify-content:center; }
.app-hidden{ visibility:hidden; }
.shell{ width:min(1380px, 100%); display:flex; flex-direction:column; gap:14px; }

.topbar{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding:14px 14px;
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  background:var(--card2);
  box-shadow:var(--shadow-soft);
}
.brand{ display:flex; align-items:center; gap:12px; }
.brand-mark{
  width:40px; height:40px; border-radius:12px;
  display:grid; place-items:center;
  border:1px solid rgba(56,189,248,.35);
  background:var(--accent-soft);
  color:var(--accent);
  font-weight:800;
}
.brand-text h1{ margin:0; font-size:16px; letter-spacing:.2px; }
.brand-text p{ margin:4px 0 0; color:var(--text-sub); font-size:12px; font-family:var(--mono); }
.auth-text{ opacity:.95; }
.topbar-right{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }

.viewbar{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
  padding:10px 12px;
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  background:var(--card2);
}

.kpi-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap:12px; }
.kpi-card{
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  background:var(--card);
  box-shadow:var(--shadow-soft);
  padding:12px 14px;
}
.kpi-label{ color:var(--text-sub); font-size:12px; }
.kpi-value{ font-size:20px; font-weight:800; margin-top:6px; letter-spacing:.2px; }
.kpi-card.success{ border-color:rgba(22,163,74,.25); }
.kpi-card.warning{ border-color:rgba(245,158,11,.25); }
.kpi-card.danger{ border-color:rgba(239,68,68,.25); }
.kpi-card.muted{ border-color:rgba(100,116,139,.35); }
.kpi-card.maintenance{ border-color:rgba(147,51,234,.25); }

.panel{
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  overflow:hidden;
  background:var(--card2);
  box-shadow:var(--shadow-soft);
}
.panel-head{
  padding:12px 14px;
  border-bottom:1px solid var(--border);
  background:var(--card2);
  display:flex; gap:12px;
  align-items:flex-start; justify-content:space-between;
  flex-wrap:wrap;
}
.filters{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; flex:1 1 520px; }
.panel-meta .hint{ color:var(--text-sub); font-size:12px; font-family:var(--mono); }

.panel-meta.range{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
}

.panel-meta-group{
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
}

.panel-head .panel-actions{
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:flex-end;
  flex-wrap:wrap;
}

.search-box{
  display:flex; align-items:center; gap:8px;
  background:var(--card);
  border:1px solid var(--border);
  padding:8px 10px;
  border-radius:999px;
  width: clamp(220px, 42vw, 520px);
}
.search-box .icon{ color:var(--text-sub); }
.input{ border:none; outline:none; background:transparent; color:var(--text); width:100%; font-size:12px; }
.search-box:focus-within{ box-shadow:var(--focus); border-color:rgba(56,189,248,.45); }

.seg{ display:flex; gap:8px; flex-wrap:wrap; }
.chip{
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text-sub);
  font-size:12px;
  padding:8px 10px;
  border-radius:999px;
  cursor:pointer;
}
.chip.active{
  color:var(--accent);
  border-color:rgba(56,189,248,.45);
  background:var(--accent-soft);
}
.chip:hover{ border-color:rgba(56,189,248,.45); color:var(--text); }
.chip:disabled{ opacity:.55; cursor:not-allowed; }

/* Users 區塊使用獨立的 chip class（避免被既有 admin JS 綁定影響）
 * 但樣式需與 client 專案的 .chip 完全一致。
 */
.client-scope .u-chip{
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text-sub);
  font-size:12px;
  padding:8px 10px;
  border-radius:999px;
  cursor:pointer;
}
.client-scope .u-chip.active{
  color:var(--accent);
  border-color:rgba(56,189,248,.45);
  background:var(--accent-soft);
}
.client-scope .u-chip:hover{ border-color:rgba(56,189,248,.45); color:var(--text); }
.client-scope .u-chip:disabled{ opacity:.55; cursor:not-allowed; }

/* Users(技師) panel head layout: keep chips right of search */
.client-scope .panel-head .filters{ flex:1 1 100%; }
.client-scope .panel-head .panel-actions{
  flex:0 0 100%;
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:flex-end;
  flex-wrap:wrap;
}

.bulkbar{
  display:flex; flex-wrap:wrap;
  align-items:flex-start; justify-content:space-between;
  gap:12px; padding:10px 14px;
  border-bottom:1px solid var(--border);
  background:var(--card2);
}
.bulk-left{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
.bulk-pill{
  display:inline-flex; align-items:center;
  padding:6px 10px; border-radius:999px;
  border:1px solid rgba(56,189,248,.35);
  background:var(--accent-soft);
  color:var(--accent);
  font-size:12px;
}
.bulk-right{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end; }
.bulk-group{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.bulk-label{ color:var(--text-sub); font-size:12px; }

.select, input[type="text"]{
  font-size:12px;
  padding:7px 10px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--input-bg);
  color:var(--text);
  outline:none;
}
.select:focus, input[type="text"]:focus{ box-shadow:var(--focus); border-color:rgba(56,189,248,.45); }

/* ================================
 * ✅ Client Users 區塊樣式（scope）
 * 目標：讓 admin 內的 Users 區塊外觀與 client 專案一致，
 *       且不影響上方 Admin 審核表格。
 * ================================ */

/* Search states (client has is-searching) */
.client-scope .search-box.is-searching{
  border-color: rgba(56,189,248,.55);
  background: var(--accent-soft);
}
.client-scope .search-box.is-searching .icon{ color: var(--accent); }

/* Table header sort affordance (style only;不強制功能) */
.client-scope thead th.sortable{ cursor:pointer; }
.client-scope thead th.sortable:hover{ color:var(--text); }
.client-scope thead th .sort-ind{ margin-left:6px; opacity:.75; }

/* mono helper (match client) */
.client-scope .mono{ font-family:var(--mono); }

/* ===== View Tabs (match client) ===== */
.client-scope #viewTabs.viewtabs{
  flex:0 0 100%;
  width:100%;
  margin-top:10px;
}
.client-scope .viewtabs{
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
}
.client-scope .viewtab{
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text-sub);
  font-size:12px;
  padding:8px 10px;
  border-radius:999px;
  cursor:pointer;
}
.client-scope .viewtab:hover{ border-color:rgba(56,189,248,.45); color:var(--text); }
.client-scope .viewtab.active{
  color:var(--accent);
  border-color:rgba(56,189,248,.45);
  background:var(--accent-soft);
}
.client-scope .viewtab:disabled{ opacity:.55; cursor:not-allowed; }

/* =========================================================
 * ✅ 欄位分類（分頁顯示/隱藏）- match client
 * table[data-view="usage" | "master" | "features" | "all"]
 * ========================================================= */

/* USAGE：顯示 1-9 + 16；隱藏 10-15 */
.client-scope table[data-view="usage"] thead th:nth-child(10),
.client-scope table[data-view="usage"] thead th:nth-child(11),
.client-scope table[data-view="usage"] thead th:nth-child(12),
.client-scope table[data-view="usage"] thead th:nth-child(13),
.client-scope table[data-view="usage"] thead th:nth-child(14),
.client-scope table[data-view="usage"] thead th:nth-child(15),
.client-scope table[data-view="usage"] tbody td:nth-child(10),
.client-scope table[data-view="usage"] tbody td:nth-child(11),
.client-scope table[data-view="usage"] tbody td:nth-child(12),
.client-scope table[data-view="usage"] tbody td:nth-child(13),
.client-scope table[data-view="usage"] tbody td:nth-child(14),
.client-scope table[data-view="usage"] tbody td:nth-child(15){
  display:none;
}

/* MASTER：顯示 1-5 + 9-11 + 16；隱藏 6-8 + 12-15 */
.client-scope table[data-view="master"] thead th:nth-child(6),
.client-scope table[data-view="master"] thead th:nth-child(7),
.client-scope table[data-view="master"] thead th:nth-child(8),
.client-scope table[data-view="master"] thead th:nth-child(12),
.client-scope table[data-view="master"] thead th:nth-child(13),
.client-scope table[data-view="master"] thead th:nth-child(14),
.client-scope table[data-view="master"] thead th:nth-child(15),
.client-scope table[data-view="master"] tbody td:nth-child(6),
.client-scope table[data-view="master"] tbody td:nth-child(7),
.client-scope table[data-view="master"] tbody td:nth-child(8),
.client-scope table[data-view="master"] tbody td:nth-child(12),
.client-scope table[data-view="master"] tbody td:nth-child(13),
.client-scope table[data-view="master"] tbody td:nth-child(14),
.client-scope table[data-view="master"] tbody td:nth-child(15){
  display:none;
}

/* FEATURES：顯示 1-5 + 9 + 12-15 + 16；隱藏 6-8 + 10-11 */
.client-scope table[data-view="features"] thead th:nth-child(6),
.client-scope table[data-view="features"] thead th:nth-child(7),
.client-scope table[data-view="features"] thead th:nth-child(8),
.client-scope table[data-view="features"] thead th:nth-child(10),
.client-scope table[data-view="features"] thead th:nth-child(11),
.client-scope table[data-view="features"] tbody td:nth-child(6),
.client-scope table[data-view="features"] tbody td:nth-child(7),
.client-scope table[data-view="features"] tbody td:nth-child(8),
.client-scope table[data-view="features"] tbody td:nth-child(10),
.client-scope table[data-view="features"] tbody td:nth-child(11){
  display:none;
}

/* expiry pill (match client) */
.client-scope .expiry-pill{
  display:inline-flex; align-items:center; gap:6px;
  padding:5px 10px; border-radius:999px;
  border:1px solid var(--border);
  font-size:12px; color:var(--text-sub);
  background:var(--card2);
}
.client-scope .expiry-pill.active{ border-color:rgba(22,163,74,.4); background:var(--success-soft); color:var(--success); }
.client-scope .expiry-pill.expired{ border-color:rgba(239,68,68,.4); background:var(--danger-soft); color:var(--danger); }
.client-scope .expiry-pill.unset{ border-color:rgba(56,189,248,.35); background:var(--accent-soft); color:var(--accent); }

/* =========================================================
 * ✅ Push Panel - match client
 * ========================================================= */
.client-scope #pushPanel{ width:100%; }
.client-scope .pushbar{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  align-items:flex-start;
  padding:10px 14px;
  border:1px solid var(--border);
  border-radius:14px;
  background:var(--card2);
}
.client-scope .pushbar-left{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  align-items:center;
  flex: 1 1 420px;
  min-width:0;
}
.client-scope .pushbar-right{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  align-items:center;
  justify-content:flex-end;
  flex: 1 1 420px;
  min-width:0;
}
.client-scope .push-message{
  flex: 1 1 260px;
  width:100%;
  min-width:0;
}
.client-scope .push-single{
  flex: 1 1 260px;
  min-width:0;
}
.client-scope #pushSendBtn{
  flex: 0 0 auto;
  white-space:nowrap;
}
@media (max-width: 520px){
  .client-scope #pushSendBtn{ width:100%; padding:10px 12px; }
  .client-scope .pushbar-right{ justify-content:flex-start; width:100%; }
}

/* audit badge (match client) */
.client-scope .audit-badge{
  display:inline-flex; align-items:center; justify-content:center;
  padding:5px 10px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--card2);
  font-size:12px;
  margin-left:8px;
  user-select:none;
/* 讓「是/否」按鈕像刪除按鈕一樣靠右 */
td.yn-cell{ text-align:right; }
}
.client-scope .audit-badge.pending{ border-color:rgba(245,158,11,.45); background:var(--warning-soft); color:var(--warning); }
.client-scope .audit-badge.approved{ border-color:rgba(22,163,74,.45); background:var(--success-soft); color:var(--success); }
.client-scope .audit-badge.rejected{ border-color:rgba(239,68,68,.45); background:var(--danger-soft); color:var(--danger); }
.client-scope .audit-badge.disabled{ border-color:rgba(100,116,139,.45); background:rgba(100,116,139,.10); color:var(--muted); }
.client-scope .audit-badge.other{ border-color:rgba(56,189,248,.45); background:var(--accent-soft); color:var(--accent); }
.client-scope .audit-badge.maintenance{
  border-color:rgba(147,51,234,.45);
  background:rgba(147,51,234,.12);
  color:rgb(167,139,250);
}

/* Sticky left col hover backgrounds (client behavior) */
.client-scope tbody tr:hover td.sticky-col{ background:rgba(56,189,248,.08); }
.client-scope tbody tr.dirty:hover td.sticky-col{ background:rgba(245,158,11,.10); }

/* Inputs (client styles date/number too) */
.client-scope input[type="date"],
.client-scope input[type="number"],
.client-scope input[type="text"],
.client-scope select{
  font-size:12px;
  padding:6px 8px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--input-bg);
  color:var(--text);
  outline:none;
}
.client-scope input[type="date"]:focus,
.client-scope input[type="number"]:focus,
.client-scope input[type="text"]:focus,
.client-scope select:focus{
  border-color:rgba(56,189,248,.55);
  box-shadow:var(--focus);
}
.client-scope input:disabled,
.client-scope select:disabled{ opacity:.55; cursor:not-allowed; }

@media (max-width: 540px){
  .client-scope .bulk-right{ width:100%; justify-content:flex-start; }
  .client-scope #uBulkApply,
  .client-scope #uBulkDelete{ width:100%; padding:10px 12px; }
}

/* ===== Mobile readability: table -> card (client behavior) ===== */
@media (max-width: 720px){
  .client-scope .panel-head{ flex-direction:column; align-items:stretch; }
  .client-scope .search-box{ width: 100%; }

  /* Mobile：避免 filters 在 column 版型被撐高，導致搜尋與 chips 中間大片空白 */
  .client-scope .filters{ flex:0 0 auto; align-content:flex-start; }

  .client-scope .table-wrap{
    overflow: visible;
    padding:12px 14px 14px;
  }

  /* Mobile 仍需可操作「全選」：只顯示第一欄的 checkbox（其餘表頭維持隱藏） */
  .client-scope thead{ display:block; }
  .client-scope thead tr{ display:block; width:100%; }
  .client-scope thead th{ display:none; }
  .client-scope thead th.col-check{
    display:flex;
    align-items:center;
    gap:10px;
    position:static;
    width:100%;
    padding:10px 10px;
    border-bottom:1px solid var(--border);
    background:var(--card);
  }
  .client-scope thead th.col-check::after{
    content:" 全選";
    color:var(--text-sub);
    font-size:12px;
  }

  .client-scope table,
  .client-scope tbody,
  .client-scope tr,
  .client-scope td{ display:block; width:100%; }

  .client-scope tbody tr{
    border:1px solid var(--border);
    border-radius:var(--radius-md);
    overflow:hidden;
    margin-bottom:10px;
    background:var(--card);
  }

  .client-scope tbody td{
    border-bottom:1px solid var(--border-soft);
    white-space: normal !important;
    display:flex;
    justify-content:space-between;
    gap:10px;
    overflow-wrap:anywhere;
    word-break:break-word;
  }

  .client-scope tbody td::before{
    content: attr(data-label);
    color:var(--text-sub);
    font-size:12px;
    min-width: 110px;
  }

  .client-scope .sticky-col{ position:static; }
  .client-scope .actions{ justify-content:flex-end; width:100%; }

  .client-scope tbody td input,
  .client-scope tbody td select{ max-width: 60%; }
}

/* 表格內更緊湊 */
.table-wrap{ overflow:auto; padding:12px 14px 14px; -webkit-overflow-scrolling:touch; }
/* For the schedule card table specifically: prevent horizontal scrolling
  and instead shrink cell paddings/font and clip overflow on overflow. */
.table-wrapper{ overflow-x: hidden; }
#performancePanelSection .table-wrapper{ overflow-x: auto; }

/* Chart horizontal scroll: allow canvas to be wider than container and enable smooth touch scrolling */
.chart-wrap{ overflow-x:auto; overflow-y:visible; -webkit-overflow-scrolling:touch; padding:12px 14px; }
.chart-wrap canvas{ display:block; max-width:none; /* allow width via inline style */ }
table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  overflow:hidden;
}
thead th{
  position:sticky; top:0; z-index:2;
  background:var(--bg);
  color:var(--text-sub);
  font-weight:700;
  font-size:12px;
  text-align:left;
  padding:11px 10px;
  border-bottom:1px solid var(--border);
  white-space:nowrap;
}
tbody td{
  padding:10px 10px;
  border-bottom:1px solid var(--border-soft);
  font-size:12px;
  white-space:nowrap;
  vertical-align:middle;
}
/* Ensure the schedule table never wraps or ellipsizes content; allow
   horizontal scrolling via the outer .table-wrap so full text is shown. */
.status-table th:nth-child(5),
.status-table td:nth-child(5) {
  white-space: nowrap;
  word-break: normal;
  overflow: visible;
  text-overflow: clip;
  max-width: none;
  min-width: 80px;
  text-align: left;
}
/* Responsive widths for schedule columns (順序, 師傅, 狀態, 預約內容, 剩餘時間) */
.status-table{
  width:100%;
  table-layout: auto; /* let browser size columns based on content */
}
.status-table th, .status-table td{
  /* Force single-line, reduce padding/font to attempt to fit; if still
     too long, content will be clipped (no horizontal scroll). */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: clip;
  padding: 6px 8px;
  font-size: 12px;
}
.status-table th:nth-child(1), .status-table td:nth-child(1){ width:6%; min-width:56px; max-width:80px; }
.status-table th:nth-child(2), .status-table td:nth-child(2){ width:18%; min-width:60px; max-width:220px; text-align:left; }
.status-table th:nth-child(3), .status-table td:nth-child(3){ width:18%; min-width:70px; max-width:220px; text-align:left; }
.status-table th:nth-child(4), .status-table td:nth-child(4){
  /* Allow appointment content to wrap and expand vertically so full
     content is visible without horizontal scrolling. */
  width: auto;
  min-width: 100px;
  max-width: none;
  text-align: left;
  white-space: normal;
  overflow: visible;
  overflow-wrap: anywhere;
  word-break: break-word;
}
.status-table th:nth-child(5), .status-table td:nth-child(5){ width:16%; min-width:60px; max-width:160px; text-align:left; }

/* Performance: allow service name to wrap (summary: col 1, detail: col 5) */
#performancePanelSection #perfDetailHeadRow th:nth-child(1),
#performancePanelSection #perfDetailRows td:nth-child(1),
#performancePanelSection #perfDetailHeadRow th:nth-child(5),
#performancePanelSection #perfDetailRows td:nth-child(5){
  white-space: normal;
  overflow: visible;
  text-overflow: clip;
  max-width: none;
}

@media (max-width: 720px){
  /* On small screens allow content to wrap and avoid fixed layout */
  .status-table{ table-layout: auto; }
  .status-table th, .status-table td{
    /* keep compact cells for most columns */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: clip;
  }
  /* But allow the appointment column to wrap on small screens */
  .status-table td:nth-child(4), .status-table th:nth-child(4){
    white-space: normal;
    overflow: visible;
    text-overflow: clip;
    overflow-wrap: anywhere;
  }
  .status-table td:nth-child(5){ text-align:left; }
}
tbody tr:nth-child(odd){ background: rgba(255,255,255,.02); }
tbody tr:nth-child(even){ background: rgba(0,0,0,.14); }
html[data-theme="light"] tbody tr:nth-child(odd){ background: rgba(0,0,0,.015); }
html[data-theme="light"] tbody tr:nth-child(even){ background: rgba(0,0,0,.04); }
tbody tr:hover{ background:rgba(56,189,248,.08); }
tbody tr.dirty{ box-shadow: inset 3px 0 0 rgba(245,158,11,.75); }

.col-check{ width:42px; }
.sticky-col{ position:sticky; left:0; z-index:3; background:var(--bg); }
tbody td.sticky-col{ background:transparent; }

.btn{
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  border-radius:12px;
  padding:8px 10px;
  cursor:pointer;
  font-size:12px;
  line-height:1;
}
.btn:hover{ border-color:rgba(56,189,248,.45); }
.btn.primary{ border-color:rgba(56,189,248,.55); background:var(--accent-soft); color:var(--accent); }
.btn.danger{ border-color:rgba(239,68,68,.55); background:var(--danger-soft); color:var(--danger); }
.btn.ghost{ background:transparent; }
.btn.icon{ padding:8px 10px; border-radius:999px; }
.btn[disabled]{ opacity:.55; cursor:not-allowed; }

/* =========================
 * Panel heading helpers
 * ========================= */

.panel-title{ display:flex; flex-direction:column; gap:6px; }
.panel-title-main{ font-weight:800; font-size:14px; letter-spacing:.2px; }
.panel-title-sub{ max-width: 880px; }

.panel-actions{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }

.actions{ display:flex; gap:8px; align-items:center; justify-content:flex-end; }
.dirty-dot{
  width:8px; height:8px; border-radius:999px;
  background:rgba(245,158,11,.9);
  display:inline-block;
  box-shadow:0 0 0 3px rgba(245,158,11,.18);
}

.toast{
  position:fixed;
  left:50%;
  bottom:18px;
  transform:translateX(-50%);
  background:var(--bg);
  border:1px solid rgba(56,189,248,.35);
  color:var(--text);
  padding:10px 14px;
  border-radius:14px;
  box-shadow:0 12px 36px rgba(0,0,0,.22);
  font-size:12px;
  opacity:0;
  pointer-events:none;
  transition:opacity .18s ease, transform .18s ease;
}
.toast.show{ opacity:1; transform:translateX(-50%) translateY(-4px); }
.toast.ok{ border-color:rgba(22,163,74,.35); }
.toast.err{ border-color:rgba(239,68,68,.35); }

/* Blocker overlay */
.blocker{
  position:fixed; inset:0;
  background:rgba(2,6,23,.82);
  display:flex; align-items:center; justify-content:center;
  padding:18px;
  z-index:999;
}
.blocker[hidden]{ display:none !important; }
.blocker-card{
  width:min(560px, 100%);
  border:1px solid rgba(148,163,184,.35);
  border-radius:16px;
  padding:16px;
  background:rgba(2,6,23,.75);
  color:var(--text);
  box-shadow:0 18px 46px rgba(0,0,0,.35);
}
.blocker-badge{
  display:inline-block;
  font-family:var(--mono);
  font-size:12px;
  padding:4px 8px;
  border-radius:999px;
  border:1px solid rgba(56,189,248,.35);
  background:rgba(56,189,248,.12);
  color:var(--accent);
}
.blocker-title{ margin:10px 0 6px; font-size:18px; }
.blocker-msg{ margin:0 0 10px; color:var(--text-sub); line-height:1.6; }
.blocker-meta{
  font-family:var(--mono);
  font-size:12px;
  color:#cbd5e1;
  background:rgba(255,255,255,.04);
  border:1px solid rgba(148,163,184,.25);
  padding:10px 12px;
  border-radius:12px;
  white-space:pre-wrap;
}
.blocker-actions{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }

@media (max-width: 720px){
  .panel-head{ flex-direction:column; align-items:stretch; }
  .search-box{ width:100%; }

  /* Mobile：避免 filters 在 column 版型被撐高，導致搜尋與 chips 中間大片空白 */
  .filters{ flex:0 0 auto; align-content:flex-start; }

  /* Admin 主表格：手機版 table -> card（需搭配 td[data-label]） */
  .responsive-wrap{
    overflow: visible;
    padding:10px 10px 12px;
  }

  /* Mobile 仍需可操作「全選」：只顯示第一欄的 checkbox（其餘表頭維持隱藏） */
  .responsive-table thead{ display:block; }
  .responsive-table thead tr{ display:block; width:100%; }
  .responsive-table thead th{ display:none; }
  .responsive-table thead th.col-check{
    display:flex;
    align-items:center;
    gap:10px;
    position:static;
    width:100%;
    padding:10px 10px;
    border-bottom:1px solid var(--border);
    background:var(--card);
  }
  .responsive-table thead th.col-check::after{
    content:" 全選";
    color:var(--text-sub);
    font-size:12px;
  }

  .responsive-table,
  .responsive-table tbody,
  .responsive-table tr,
  .responsive-table td{ display:block; width:100%; }

  .responsive-table tbody tr{
    border:1px solid var(--border);
    border-radius:var(--radius-md);
    overflow:hidden;
    margin-bottom:10px;
    background:var(--card);
  }

  .responsive-table tbody td{
    border-bottom:1px solid var(--border-soft);
    white-space: normal !important;
    display:flex;
    justify-content:flex-start;
    gap:8px;
    overflow-wrap:anywhere;
    word-break:break-word;
  }
  /* 手機 card 模式下：標籤在左、是/否按鈕在右 */
  .responsive-table tbody td.yn-cell{ justify-content:space-between; }
  .responsive-table tbody td.yn-cell .yn-toggle{ margin-left:auto; }

  .responsive-table tbody td::before{
    content: attr(data-label);
    color:var(--text-sub);
    font-size:12px;
    min-width: 88px;
  }

  .responsive-table .sticky-col,
  .responsive-table .sticky-right{ position:static; }

  /* Admins 主表：手機 card 模式不使用右側 sticky 欄位群 */
  #adminsTable thead th:nth-child(n+8):nth-child(-n+18),
  #adminsTable tbody td:nth-child(n+8):nth-child(-n+18){
    position: static;
    right: auto;
    z-index: auto;
    width: auto;
    min-width: 0;
    max-width: none;
    background: transparent;
  }

  .responsive-table .actions{ justify-content:flex-end; width:100%; flex-wrap:wrap; }

  /* 避免內容撐爆右側 */
  .responsive-table tbody td input,
  .responsive-table tbody td select{ max-width: 60%; }
}

/* Tech Usage panel: 更友善的行動裝置排列 */
@media (max-width: 720px){
  #techUsageLogsPanelSection .panel-actions{
    display:grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap:8px;
    align-items:center;
    justify-items:stretch;
  }
  #techUsageLogsPanelSection .panel-actions .bulk-label{ display:none; }
  #techUsageLogsPanelSection .panel-actions .select,
  #techUsageLogsPanelSection .panel-actions .btn{ width:100%; }
}

@media (max-width: 420px){
  #techUsageLogsPanelSection .panel-actions{
    grid-template-columns: 1fr;
  }
  #techUsageLogsPanelSection .panel-actions .select,
  #techUsageLogsPanelSection .panel-actions .btn{ width:100%; }
}

/* Admin Logs panel mobile layout (match tech usage) */
@media (max-width: 720px){
  #adminLogsPanelSection .panel-actions{
    display:grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap:8px;
    align-items:center;
    justify-items:stretch;
  }
  #adminLogsPanelSection .panel-actions .bulk-label{ display:none; }
  #adminLogsPanelSection .panel-actions .select,
  #adminLogsPanelSection .panel-actions .btn{ width:100%; }
}

@media (max-width: 420px){
  #adminLogsPanelSection .panel-actions{
    grid-template-columns: 1fr;
  }
  #adminLogsPanelSection .panel-actions .select,
  #adminLogsPanelSection .panel-actions .btn{ width:100%; }
}

/* === 固定最右操作欄（避免刪除按鈕跑位） === */
th.sticky-right,
td.sticky-right{
  position: sticky;
  right: 0;
  z-index: 4;
  background: var(--bg);
}
tbody td.sticky-right{
  background: transparent;
}

/* === Admins 主表：右側固定「是/否」欄位群（桌機） ===
 * 欄位順序（1-indexed）：
 * 1:check,2:#,3:userId,4:name,5:audit,6:createdAt,7:lastLogin,
 * 8~18:是/否欄位, 19:操作(sticky-right)
 */
#adminsTable{
  --yn-col-w: 96px;
  --op-col-w: 120px;
}

/* 操作欄固定寬度，避免每列因內容不同而抖動 */
#adminsTable th.sticky-right,
#adminsTable td.sticky-right{
  width: var(--op-col-w);
  min-width: var(--op-col-w);
  max-width: var(--op-col-w);
}

/* 是/否欄固定寬度 + 內容靠右（桌機） */
#adminsTable td.yn-cell{ text-align:right; }
#adminsTable thead th:nth-child(n+8):nth-child(-n+18),
#adminsTable tbody td:nth-child(n+8):nth-child(-n+18){
  width: var(--yn-col-w);
  min-width: var(--yn-col-w);
  max-width: var(--yn-col-w);
}

/* 右側固定：把 8~18 欄位逐一 sticky 到操作欄左側（避免橫向捲動時找不到） */
#adminsTable thead th:nth-child(n+8):nth-child(-n+18){
  position: sticky;
  z-index: 5;
  background: var(--bg);
}

#adminsTable tbody td:nth-child(n+8):nth-child(-n+18){
  position: sticky;
  z-index: 4;
  background: inherit;
}

/* 讓操作欄蓋在最上層，避免邊界重疊 */
#adminsTable thead th.sticky-right{ z-index: 6; }
#adminsTable tbody td.sticky-right{ z-index: 5; background: inherit; }

/* 右側 offset：第 18 欄貼著操作欄，往左依序累加 yn 欄寬 */
#adminsTable thead th:nth-child(18),
#adminsTable tbody td:nth-child(18){ right: var(--op-col-w); }

#adminsTable thead th:nth-child(17),
#adminsTable tbody td:nth-child(17){ right: calc(var(--op-col-w) + 1 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(16),
#adminsTable tbody td:nth-child(16){ right: calc(var(--op-col-w) + 2 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(15),
#adminsTable tbody td:nth-child(15){ right: calc(var(--op-col-w) + 3 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(14),
#adminsTable tbody td:nth-child(14){ right: calc(var(--op-col-w) + 4 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(13),
#adminsTable tbody td:nth-child(13){ right: calc(var(--op-col-w) + 5 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(12),
#adminsTable tbody td:nth-child(12){ right: calc(var(--op-col-w) + 6 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(11),
#adminsTable tbody td:nth-child(11){ right: calc(var(--op-col-w) + 7 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(10),
#adminsTable tbody td:nth-child(10){ right: calc(var(--op-col-w) + 8 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(9),
#adminsTable tbody td:nth-child(9){ right: calc(var(--op-col-w) + 9 * var(--yn-col-w)); }

#adminsTable thead th:nth-child(8),
#adminsTable tbody td:nth-child(8){ right: calc(var(--op-col-w) + 10 * var(--yn-col-w)); }

/* === 技師欄位「是/否」切換按鈕（替代 select，避免無法展開/被裁切） === */
.yn-toggle{
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  border-radius:999px;
  padding:7px 10px;
  font-size:12px;
  line-height:1;
  cursor:pointer;
  user-select:none;
  min-width:52px;
  text-align:center;
}
.yn-toggle:hover{ border-color:rgba(56,189,248,.45); }
.yn-toggle[data-val="是"]{
  border-color:rgba(22,163,74,.45);
  background:rgba(22,163,74,.12);
  color:#22c55e;
}
.yn-toggle[data-val="否"]{
  border-color:rgba(239,68,68,.35);
  background:rgba(239,68,68,.10);
  color:#fb7185;
}
.yn-toggle:focus{ outline:none; box-shadow:var(--focus); }

/* 初始資料載入遮罩 */
.initial-loading{
  position:fixed;
  inset:0;
  z-index:12000;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(15, 23, 42, 0.96);
  color:#e5e7eb;
  transition:opacity .22s ease, visibility .22s ease;
}

html[data-theme="light"] .initial-loading{
  background:#ffffff;
  color:#0f172a;
}

.initial-loading-hidden{
  opacity:0;
  visibility:hidden;
  pointer-events:none;
}

.initial-loading-inner{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:14px;
  padding:24px 28px;
  border-radius:18px;
  background:rgba(15, 23, 42, 0.78);
  border:1px solid rgba(148, 163, 184, 0.35);
  box-shadow:0 18px 48px rgba(0,0,0,0.35);
  backdrop-filter:blur(10px);
}

html[data-theme="light"] .initial-loading-inner{
  background:rgba(255, 255, 255, 0.86);
  border-color:rgba(148, 163, 184, 0.45);
  box-shadow:0 16px 38px rgba(0,0,0,0.12);
}

.initial-loading-text{ font-size:15px; letter-spacing:.02em; }

.initial-loading-progress{
  width:min(360px, 72vw);
  height:10px;
  border-radius:999px;
  border:1px solid rgba(148, 163, 184, 0.35);
  background:rgba(2, 6, 23, 0.35);
  overflow:hidden;
}

html[data-theme="light"] .initial-loading-progress{
  border-color:rgba(148, 163, 184, 0.45);
  background:rgba(15, 23, 42, 0.06);
}

.initial-loading-progress-bar{
  height:100%;
  width:0%;
  border-radius:999px;
  background:var(--accent);
  box-shadow:0 0 0 3px rgba(56,189,248,.10);
  transition:width .22s ease;
}

.initial-loading-percent{
  font-size:12px;
  color:var(--text-sub);
  font-family:var(--mono);
}

.spinner-lg{
  width:32px;
  height:32px;
  border-radius:999px;
  border:3px solid rgba(148, 163, 184, 0.35);
  border-top-color:var(--accent);
  animation:spin .85s linear infinite;
}

@keyframes spin{ to{ transform: rotate(360deg); } }

/* Tech usage chart styles */
.chart-wrap{ width:100%; max-width:100%; display:block; }
.chart-wrap canvas{ width:100% !important; height:360px !important; max-height:520px; }

/* ======= Scheduling: 專用排班樣式（scoped to schedule panel） ======= */
#schedulePanelSection .card-table .status-table {
  width: 100%;
  min-width: 0;
  table-layout: fixed;
  font-size: 12px;
}

#schedulePanelSection .card-table .status-table th,
#schedulePanelSection .card-table .status-table td {
  overflow: hidden;
  padding: 6px 6px;
}

#schedulePanelSection .card-table .status-table thead th:nth-child(1),
#schedulePanelSection .card-table .status-table tbody td:nth-child(1) {
  width: clamp(44px, 12vw, 56px) !important;
}

#schedulePanelSection .card-table .status-table thead th:nth-child(2),
#schedulePanelSection .card-table .status-table tbody td:nth-child(2) {
  width: clamp(44px, 12vw, 56px) !important;
}

#schedulePanelSection .card-table .status-table thead th:nth-child(3),
#schedulePanelSection .card-table .status-table tbody td:nth-child(3) {
  width: clamp(84px, 24vw, 120px) !important;
}

#schedulePanelSection .card-table .status-table thead th:nth-child(5),
#schedulePanelSection .card-table .status-table tbody td:nth-child(5) {
  width: clamp(64px, 18vw, 104px) !important;
  text-align: right;
}

#schedulePanelSection .card-table .status-table tbody td:nth-child(4) {
  white-space: nowrap;
  text-overflow: ellipsis;
  min-width: 0;
  box-shadow: inset -1px 0 0 var(--border);
}

#schedulePanelSection .card-table .status-table tbody td:nth-child(4) .appt-block {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

#schedulePanelSection .card-table .status-table tbody td:nth-child(3) .status-pill {
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
}

#schedulePanelSection .card-table .status-table tbody td:nth-child(5) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

#schedulePanelSection .time-badge {
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  display: inline-block;
}

@media (max-width: 720px){
  /* On small screens, further reduce font-size and padding to fit more
     content horizontally; still no horizontal scroll and content will
     be clipped if it overflows. */
  .status-table th, .status-table td{
    white-space: nowrap;
    overflow: hidden;
    text-overflow: clip;
    padding: 4px 6px;
    font-size: 11px;
  }
  @media (max-width: 420px){
    .status-table th, .status-table td{
      padding: 3px 6px;
      font-size: 10px;
    }
  }
    font-size: 11px;
  }

  #schedulePanelSection .card-table .status-table thead th:nth-child(5),
  #schedulePanelSection .card-table .status-table tbody td:nth-child(5) {
    width: clamp(56px, 16vw, 88px) !important;
  }

  #schedulePanelSection .card-table .status-table tbody td:nth-child(5) .time-badge {
    padding: 2px 8px;
  }

  /* ensure table retains a reasonable min-width for horizontal scroll on small screens */
  #schedulePanelSection .status-table {
    min-width: 680px;
  }
}

/* end scheduling scoped styles */

/* ===== Scheduling theme vars (scoped) ===== */
#schedulePanelSection {
  --bg: #020617;
  --bg-card: #020617;
  --bg-soft: #020617;
  --border: #1f2937;
  --text-main: #e5e7eb;
  --text-sub: #9ca3af;
  --accent: #38bdf8;
  --accent-soft: rgba(56, 189, 248, 0.15);
  --danger: #f97373;
  --muted: #4b5563;
  --radius-lg: 16px;
  --order-bg: rgba(148, 163, 184, 0.14);
  --order-border: rgba(148, 163, 184, 0.30);
  --order-text-shadow: 0 1px 0 rgba(0,0,0,0.55), 0 0 10px rgba(255,255,255,0.10);
}

/* Tabs (Scheduling style) */
#schedulePanelSection .tab {
  border:1px solid var(--border);
  background:var(--bg-card);
  color:var(--text-sub);
  font-size:13px;
  padding:8px 12px;
  border-radius:999px;
  cursor:pointer;
}
#schedulePanelSection .tab.tab-active{
  color:var(--accent);
  border-color:rgba(56,189,248,.45);
  background:var(--accent-soft);
}

/* Buttons styling to match Scheduling */
#schedulePanelSection .btn {
  padding:6px 12px;
  border-radius:8px;
  border:1px solid var(--border);
  background:var(--bg-card);
  color:var(--text-main);
}
#schedulePanelSection .btn.ghost{ background:transparent; }

/* table wrapper to match scheduling */
#schedulePanelSection .table-wrapper, #schedulePanelSection .table-wrap{ overflow:auto; -webkit-overflow-scrolling:touch; }

/* ===== 師傅狀態卡（移植自 Scheduling：左側色條 + 內容區） ===== */
#schedulePanelSection .my-master-status{
  margin: 0 0 14px 0;
  padding: 10px 14px;
  border-radius: 16px;
  border: 1px solid rgba(148, 163, 184, 0.55);
  background: rgba(15, 23, 42, 0.65);
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  gap: 8px;
  position: relative;
  overflow: hidden;
}

html[data-theme="light"] #schedulePanelSection .my-master-status{
  background: rgba(255, 255, 255, 0.85);
  border-color: rgba(148, 163, 184, 0.65);
}

#schedulePanelSection .my-master-status::before{
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 6px;
  background: var(--myStripe, rgba(148, 163, 184, 0.55));
}

/* fallback stripe colors (JS 會用 token 覆蓋 --myStripe) */
#schedulePanelSection .my-master-status.status-shift{ --myStripe: rgba(250, 204, 21, 0.9); }
#schedulePanelSection .my-master-status.status-busy{ --myStripe: rgba(248, 113, 113, 0.9); }
#schedulePanelSection .my-master-status.status-booked{ --myStripe: rgba(56, 189, 248, 0.9); }
#schedulePanelSection .my-master-status.status-free{ --myStripe: rgba(34, 197, 94, 0.9); }
#schedulePanelSection .my-master-status.status-other{ --myStripe: rgba(148, 163, 184, 0.7); }

#schedulePanelSection .my-master-title{
  font-size: 12px;
  color: var(--text-sub);
  white-space: nowrap;
  padding-top: 2px;
  font-weight: 700;
  letter-spacing: .02em;
}

#schedulePanelSection .my-master-text{
  padding-left: 6px;
  min-width: 0;
}

#schedulePanelSection .my-master-head{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

#schedulePanelSection .my-master-controls{
  display: flex;
  align-items: center;
  gap: 8px;
}

#schedulePanelSection .my-master-controls .filter-label{
  margin: 0;
  font-size: 12px;
  font-weight: 700;
  color: var(--text-sub);
  letter-spacing: .02em;
  white-space: nowrap;
}

#schedulePanelSection .my-master-controls .select{
  min-width: 140px;
  min-height: 40px;
}

/* ensure headings/text use scheduling tokens */
#schedulePanelSection .card-title, #schedulePanelSection .app-title { color: var(--text-main); }

/* Mobile: 移除卡片樣式，讓排班呈現與 Scheduling 專案一致 */
@media (max-width: 420px) {
  /* container visual resets */
  #schedulePanelSection .panel,
  #schedulePanelSection .card,
  #schedulePanelSection .panel-head,
  #schedulePanelSection .panel-body,
  #schedulePanelSection .card-body,
  #schedulePanelSection .card-table {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    border-radius: 0 !important;
  }

  /* reduce paddings to match Scheduling mobile compact layout */
  #schedulePanelSection .panel-head,
  #schedulePanelSection .panel-body,
  #schedulePanelSection .card-body {
    padding-left: 8px !important;
    padding-right: 8px !important;
  }

  /* make header stack and remove extra spacing */
  #schedulePanelSection .card-header {
    flex-direction: column !important;
    gap: 6px !important;
    align-items: flex-start !important;
  }

  /* ensure table remains horizontally scrollable but visually flat */
  #schedulePanelSection .status-table { min-width: 680px; }

  /* theme/usage banners flatten */
  #schedulePanelSection .feature-banner,
  #schedulePanelSection .usage-banner {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    border-radius: 0 !important;
  }

  #schedulePanelSection .my-master-head{
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }

  #schedulePanelSection .my-master-controls{
    width: 100%;
    flex-direction: column;
    align-items: stretch;
    gap: 6px;
  }

  #schedulePanelSection .my-master-controls .select{
    width: 100%;
    min-width: 0;
  }
}

/* ===== UI 排版優化（schedule panel 專用） ===== */
#schedulePanelSection .tab{
  font-size:14px;
  padding:10px 14px;
  min-height:44px;
}

#schedulePanelSection .btn{
  min-height:44px;
  padding:10px 14px;
  font-size:14px;
  border-radius:10px;
}

#schedulePanelSection .card-title{ font-size:16px; margin:0; }

#schedulePanelSection .status-table thead th{ padding:10px 8px; font-size:13px; }
#schedulePanelSection .status-table tbody td{ padding:12px 8px; font-size:14px; }

/* improve touch target and row spacing */
#schedulePanelSection .status-table tbody tr{ min-height:56px; }

@media (max-width: 420px){
  #schedulePanelSection .status-table tbody td{ padding:12px 10px; font-size:13px; }
  #schedulePanelSection .tab{ font-size:13px; padding:8px 12px; }
  #schedulePanelSection .btn{ min-height:44px; padding:12px 14px; }

  /* compress header spacing on narrow screens */
  #schedulePanelSection .card-header{ padding:8px 6px; }
  #schedulePanelSection .card-body{ padding:6px 6px; }

  /* make controls full-width for easier tapping */
  #schedulePanelSection .tab, #schedulePanelSection .btn{ width:100%; box-sizing:border-box; }
}

/* Visual help: slightly stronger header contrast for readability */
#schedulePanelSection .card-header{ background: linear-gradient(180deg, rgba(0,0,0,0.04), transparent); }

/* ensure horizontal scroll shows enough padding */
#schedulePanelSection .table-wrapper{ padding-bottom:12px; }

/* Header contrast and time-badge */
#schedulePanelSection .status-table thead th{
  background: var(--bg-card);
  color: var(--text-main);
  border-bottom: 1px solid rgba(255,255,255,0.06);
}

#schedulePanelSection .time-badge{
  background: rgba(255,255,255,0.03);
  color: var(--text-sub);
  padding:4px 8px;
  border-radius:999px;
  font-size:12px;
}

#schedulePanelSection .status-pill{ opacity:0.98; font-weight:600; }
#schedulePanelSection .appt-block .token{ filter: saturate(1.06); }

/* --- Layout refinements --- */
/* sticky header for long lists */
#schedulePanelSection .status-table thead th{
  position: sticky;
  top: 0;
  z-index: 3;
  backdrop-filter: blur(4px) saturate(1.02);
}

/* zebra stripes and hover for better scanability */
#schedulePanelSection .status-table tbody tr:nth-child(even){
  background: rgba(0,0,0,0.02);
}
#schedulePanelSection .status-table tbody tr:hover{
  background: rgba(255,255,255,0.03);
}

/* ===== Performance panel (Scheduling移植) ===== */
#performancePanelSection .panel-body{
  padding:12px 14px;
}

#performancePanelSection .card{
  border-radius:16px;
  border:1px solid var(--border);
  background: var(--card);
  box-shadow: var(--shadow-soft);
  overflow:hidden;
}

#performancePanelSection .card-header{
  padding:12px 14px;
  border-bottom:1px solid var(--border);
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
}

#performancePanelSection .card-title{ font-size:16px; margin:0; }
#performancePanelSection .card-subtitle{ color: var(--text-sub); font-size:12px; margin:0; }

#performancePanelSection .badge{
  border:1px solid var(--border);
  padding:4px 8px;
  border-radius:999px;
  font-size:12px;
  color:var(--text-sub);
}

#performancePanelSection .filters.perf-filters{
  width:100%;
  display:grid;
  /* auto-fit: adapt smoothly across devices without hard breakpoints */
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  align-items:end;
  gap:10px;
}

/* Match Scheduling: filter layout + labels + inputs */
#performancePanelSection .filter{
  display:flex;
  flex-direction:column;
  gap:4px;
  min-width:0;
  width:100%;
}

#performancePanelSection .filter-label{
  font-size:12px;
  color:var(--text-sub);
}

#performancePanelSection .input,
#performancePanelSection .select{
  width:100%;
  max-width:100%;
  min-width:0;

  border-radius:999px;
  border:1px solid var(--border);
  background:var(--input-bg);
  color:var(--text);
  padding:7px 10px;
  font-size:13px;
  outline:none;
}

#performancePanelSection .input:focus,
#performancePanelSection .select:focus{
  box-shadow:var(--focus);
  border-color:rgba(56,189,248,.45);
}

/* iOS / LINE WebView: date input indicator safety (match Scheduling) */
#performancePanelSection input[type="date"].input{
  min-height:44px;
  padding:10px 48px 10px 12px;
  position:relative;
  line-height:1.2;
  -webkit-appearance:none;
  appearance:none;
  box-sizing:border-box;
  overflow:hidden;
}

#performancePanelSection input[type="date"].input::-webkit-date-and-time-value{
  text-align:left;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

#performancePanelSection input[type="date"].input::-webkit-calendar-picker-indicator{
  opacity:0.85;
  cursor:pointer;
  position:absolute;
  right:12px;
  top:50%;
  transform:translateY(-50%);
}

#performancePanelSection .perf-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

#performancePanelSection .perf-actions .btn{
  flex:1 1 140px;
  min-width:0;
}

@media (max-width: 720px){
  #performancePanelSection .filters.perf-filters{
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  /* Mobile layout order:
   * Row 1: TechNo (full)
   * Row 2: Start | End (together)
   * Row 3: Actions (full)
   */
  #performancePanelSection .perf-tech-cell{ grid-column: 1 / -1; }

  /* Make the action cell span full row on mobile */
  #performancePanelSection .perf-actions-cell{
    grid-column: 1 / -1;
  }

  #performancePanelSection input[type="date"].input{
    padding-right:64px;
  }
}

@media (max-width: 420px){
  #performancePanelSection .filters.perf-filters{
    /* Keep Start/End together on phones */
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  /* Stack buttons full-width on very small screens */
  #performancePanelSection .perf-actions{ gap:8px; }
  #performancePanelSection .perf-actions .btn{ flex:1 1 100%; }

  #performancePanelSection input[type="date"].input{
    padding-right:72px;
  }
}

@media (max-width: 340px){
  /* Extreme small screens: fall back to 1 column to prevent overflow */
  #performancePanelSection .filters.perf-filters{ grid-template-columns: 1fr; }
}

#performancePanelSection .status-table{
  width:100%;
  border-collapse:collapse;
}

#performancePanelSection .status-table th,
#performancePanelSection .status-table td{
  padding:8px 10px;
  border-bottom:1px solid var(--border-soft);
  font-size:12px;
}

#performancePanelSection .table-wrapper{ overflow:auto; }

#performancePanelSection .chart-toolbar{
  display:flex;
  align-items:center;
  gap:8px;
  justify-content:space-between;
  flex-wrap:wrap;
}

#performancePanelSection .chart-modes{ display:flex; gap:6px; flex-wrap:wrap; }

#performancePanelSection .btn-chart-mode,
#performancePanelSection .btn-chart-reset{
  padding:6px 10px;
  font-size:12px;
}

#performancePanelSection .chart-toggle{
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
  margin-bottom:6px;
}

#performancePanelSection .toggle-chip{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 8px;
  border-radius:16px;
  background: var(--card);
  border:1px solid var(--border-soft);
  font-size:12px;
}

#performancePanelSection .chart-wrapper{ overflow-x:auto; -webkit-overflow-scrolling: touch; }

/* perf summary table */
#performancePanelSection .perf-summary-table{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
  font-variant-numeric: tabular-nums;
}

#performancePanelSection .perf-summary-table th,
#performancePanelSection .perf-summary-table td{
  padding:6px 8px;
  line-height:1.15;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  border-bottom:1px solid var(--border-soft);
}

#performancePanelSection .perf-summary-table thead th{
  font-size:12px;
  font-weight:700;
  color:var(--text-sub);
}

#performancePanelSection .perf-summary-table tbody td{
  font-size:13px;
  font-weight:600;
}

#performancePanelSection .perf-summary-table th:first-child,
#performancePanelSection .perf-summary-table td:first-child{
  width:22%;
  text-align:left;
}

#performancePanelSection .perf-summary-table th:nth-child(2),
#performancePanelSection .perf-summary-table td:nth-child(2),
#performancePanelSection .perf-summary-table th:nth-child(3),
#performancePanelSection .perf-summary-table td:nth-child(3),
#performancePanelSection .perf-summary-table th:nth-child(4),
#performancePanelSection .perf-summary-table td:nth-child(4){
  width:15%;
  text-align:right;
}

#performancePanelSection .perf-summary-table th:nth-child(5),
#performancePanelSection .perf-summary-table td:nth-child(5){
  width:33%;
  text-align:right;
  font-weight:800;
}

/* cap widths for key columns to prevent overflow */
#schedulePanelSection .status-table tbody td:first-child{
  width:220px;
  max-width:220px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* =========================
 * Schedule status colors (sync with GAS palette)
 * Classes produced by scheduling JS: status-shift, status-busy, status-booked, status-free, status-other
 * Apply to both `.status-pill` and container `.my-master-status` for consistency
 * ========================= */
#schedulePanelSection .status-pill,
#schedulePanelSection .status-pill {
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--card2);
  color:var(--text);
  font-weight:600;
  font-size:13px;
}

#schedulePanelSection .status-pill.status-shift,
#schedulePanelSection .status-pill.status-shift{
  border-color: rgba(22,163,74,.35);
  background: var(--success-soft);
  color: var(--success);
}

#schedulePanelSection .status-pill.status-busy,
#schedulePanelSection .status-pill.status-busy{
  border-color: rgba(239,68,68,.35);
  background: var(--danger-soft);
  color: var(--danger);
}

#schedulePanelSection .status-pill.status-booked,
#schedulePanelSection .status-pill.status-booked{
  border-color: rgba(56,189,248,.35);
  background: var(--accent-soft);
  color: var(--accent);
}

#schedulePanelSection .status-pill.status-free,
#schedulePanelSection .status-pill.status-free{
  border-color: rgba(100,116,139,.25);
  background: rgba(100,116,139,.06);
  color: var(--muted);
}

#schedulePanelSection .status-pill.status-other,
#schedulePanelSection .status-pill.status-other{
  border-color: rgba(148,163,184,.18);
  background: var(--card);
  color: var(--text-sub);
}

/* Light theme overrides: ensure sufficient contrast on light backgrounds */
html[data-theme="light"] #schedulePanelSection .status-pill,
html[data-theme="light"] #schedulePanelSection .status-pill {
  border-color: rgba(148,163,184,.35);
  background: rgba(255,255,255,.9);
  color: var(--text);
}

html[data-theme="light"] #schedulePanelSection .status-pill.status-shift,
html[data-theme="light"] #schedulePanelSection .status-pill.status-shift{
  border-color: rgba(22,163,74,.45);
  background: rgba(22,163,74,.08);
  color: rgba(22,163,74,1);
}

html[data-theme="light"] #schedulePanelSection .status-pill.status-busy,
html[data-theme="light"] #schedulePanelSection .status-pill.status-busy{
  border-color: rgba(239,68,68,.45);
  background: rgba(239,68,68,.06);
  color: rgba(239,68,68,1);
}

html[data-theme="light"] #schedulePanelSection .status-pill.status-booked,
html[data-theme="light"] #schedulePanelSection .status-pill.status-booked{
  border-color: rgba(56,189,248,.45);
  background: rgba(56,189,248,.06);
  color: rgba(7,89,133,1);
}

html[data-theme="light"] #schedulePanelSection .status-pill.status-free,
html[data-theme="light"] #schedulePanelSection .status-pill.status-free{
  border-color: rgba(100,116,139,.3);
  background: rgba(100,116,139,.06);
  color: rgba(55,65,81,1);
}

html[data-theme="light"] #schedulePanelSection .status-pill.status-other,
html[data-theme="light"] #schedulePanelSection .status-pill.status-other{
  border-color: rgba(148,163,184,.25);
  background: rgba(247,249,250,1);
  color: var(--text-sub);
}

/* ------------------------------------------------------------------
 * Schedule panel — targeted fixes for mobile vertical-text and spacing
 * - Force horizontal writing mode for the schedule panel only (minimal scope)
 * - Normalize word-break/overflow-wrap and improve touch targets
 * - Keep desktop/tablet behavior intact via narrow selectors
 * ------------------------------------------------------------------ */
#schedulePanelSection{
  font-size:14px; /* slightly larger for readability */
  line-height:1.45;
}

#schedulePanelSection, #schedulePanelSection * {
  writing-mode: horizontal-tb !important;
  text-orientation: mixed !important;
  word-break: normal !important;
  overflow-wrap: anywhere !important;
  white-space: normal !important;
  -webkit-text-size-adjust: 100% !important;
}

#schedulePanelSection .status-table thead th,
#schedulePanelSection .status-table tbody td{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

@media (max-width: 720px){
  /* mobile card mode: allow label/value wrapping but prevent one-char-per-line */
  #schedulePanelSection .status-table tbody td{
    white-space: normal !important;
    overflow-wrap: anywhere !important;
    word-break: normal !important;
    padding:12px 12px !important;
    font-size:14px !important;
  }
}
#schedulePanelSection .status-table tbody td:nth-child(2){
  width:140px;
  max-width:160px;
  white-space:nowrap;
}

/* Filters / controls spacing */
#schedulePanelSection .filters{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
#schedulePanelSection .filters .form-control, #schedulePanelSection .filters .btn{ min-height:40px; }

/* Align search & status filter labels and controls in schedule toolbar */
#schedulePanelSection .filters .filter{
  display:flex;
  align-items:center;
  gap:8px;
}
#schedulePanelSection .filters .filter .filter-label{
  display:inline-block;
  width:84px; /* fixed label width so controls align */
  color:var(--text-sub);
  font-size:12px;
}
#schedulePanelSection .filters .filter .input,
#schedulePanelSection .filters .filter .select{
  min-width:140px;
}

@media (max-width: 720px){
  /* stack filters on small screens */
  #schedulePanelSection .filters .filter{
    flex-direction:column;
    align-items:flex-start;
  }
  #schedulePanelSection .filters .filter .filter-label{ width:auto; }
  #schedulePanelSection .filters .filter .input,
  #schedulePanelSection .filters .filter .select{ min-width:100%; width:100%; }
}

/* subtle focus ring for keyboard users */
#schedulePanelSection .btn:focus, #schedulePanelSection .form-control:focus{
  outline:2px solid rgba(100,150,255,0.18);
  outline-offset:2px;
}

/* last update alignment */
#schedulePanelSection .lastUpdate{ text-align:right; font-size:13px; color:var(--text-sub); }

@media (max-width: 420px){
  /* slightly larger tap targets on very small screens */
  #schedulePanelSection .status-table tbody td{ padding:14px 12px; }
  #schedulePanelSection .status-table tbody tr{ min-height:64px; }

  /* collapse some wide columns visually by allowing wrap */
  #schedulePanelSection .status-table tbody td{ white-space:normal; }
}

/* end UI 排版優化 */

/* ------------------------------------------------------------------
 * Mobile fixes for schedule table
 * - reduce fixed first-column width on narrow screens
 * - allow status / appt / time badges to wrap safely
 * - prefer horizontal scroll when necessary but avoid content overflow
 * ------------------------------------------------------------------ */
@media (max-width: 520px) {
  /* allow the schedule table to shrink to container width when possible */
  #schedulePanelSection .status-table {
    min-width: 100% !important;
    table-layout: auto !important;
  }

  /* shrink the left column (order/id) so it doesn't push content off-screen */
  #schedulePanelSection .status-table tbody td:first-child,
  #schedulePanelSection .status-table thead th:first-child {
    width: clamp(44px, 12vw, 72px) !important;
    max-width: 72px !important;
    white-space: normal !important;
    overflow-wrap: anywhere !important;
    word-break: normal !important;
  }

  /* allow status and appointment cells to wrap instead of forcing overflow */
  #schedulePanelSection .status-table tbody td:nth-child(3),
  #schedulePanelSection .status-table tbody td:nth-child(4),
  #schedulePanelSection .status-table tbody td:nth-child(5) {
    white-space: normal !important;
    overflow-wrap: anywhere !important;
    word-break: break-word !important;
  }

  /* make pills and badges wrap safely and reduce padding slightly */
  #schedulePanelSection .status-pill,
  #schedulePanelSection .appt-block,
  #schedulePanelSection .time-badge {
    white-space: normal !important;
    overflow-wrap: anywhere !important;
    word-break: break-word !important;
    font-size: 12px !important;
    display: inline-block !important;
  }

  /* slightly reduce row padding for narrow screens */
  #schedulePanelSection .status-table tbody td { padding: 10px 8px !important; }
}
