<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINE Login (無後端)</title>
    <script>
        const CLIENT_ID = "2005939681"; // 請填入你的 LINE Channel ID
        const REDIRECT_URI = "https://yongshengchen0615.github.io/ReserveTest/"; // 請填入你的回調網址
        const SCOPE = "profile openid email";
        const STATE = Math.random().toString(36).substring(7); // 生成隨機 state 防止 CSRF 攻擊

        function loginWithLINE() {
            const url = `https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&state=${STATE}&scope=${encodeURIComponent(SCOPE)}`;
            window.location.href = url;
        }

        function getAuthCodeFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get("code");
        }

        async function getUserProfile(authCode) {
            alert(`授權碼: ${authCode}，請手動交換 access_token 來獲取用戶資訊`);
        }

        document.addEventListener("DOMContentLoaded", () => {
            const authCode = getAuthCodeFromURL();
            if (authCode) {
                getUserProfile(authCode);
            }
        });
    </script>
</head>
<body>
    <h2>使用 LINE 登入 (無後端)</h2>
    <button onclick="loginWithLINE()">登入 LINE</button>
</body>
</html>
