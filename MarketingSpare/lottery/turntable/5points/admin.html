<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>獎項後台管理</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body.admin-page{display:block;align-items:unset;justify-content:unset;padding:24px;min-height:100vh;overflow:auto}
    @media (hover: hover) and (pointer: fine){body.admin-page{overflow:auto !important}}
    h1{margin:0 0 12px;text-align:center}
    .page-subtitle{margin:0 auto 12px;max-width:960px;text-align:center;color:var(--muted);font-size:13px}
    .admin-container{max-width:960px;margin:0 auto;background:rgba(255,255,255,0.04);padding:24px 28px;border-radius:14px;box-shadow:0 6px 24px rgba(0,0,0,0.5)}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px 10px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.08);font-size:14px;vertical-align:middle}
    th{background:rgba(255,255,255,0.06);font-weight:600;position:sticky;top:0;z-index:2}
    tr:last-child td{border-bottom:none}
    input[type=text],input[type=number]{width:100%;padding:6px 8px;border:1px solid rgba(255,255,255,0.18);background:rgba(0,0,0,0.25);color:#fff;border-radius:6px;font-size:14px}
    input[type=text]:focus,input[type=number]:focus{outline:2px solid var(--accent);outline-offset:1px}
    input[type=color]{border:0;background:transparent;cursor:pointer;width:38px;height:32px;padding:0}
    .actions{display:flex;flex-wrap:wrap;gap:12px;margin-top:18px}
    button.primary{background:var(--accent);color:#08111b;font-weight:700}
    button.secondary{background:#34495e}
    button.danger{background:#c0392b}
    button{border:0;padding:10px 18px;border-radius:8px;cursor:pointer;font-size:14px;letter-spacing:.5px}
    button:disabled{opacity:.45;cursor:not-allowed}
    .status{margin-top:12px;font-size:13px;color:var(--muted)}
    .error{color:#ff6b6b;font-weight:600}
    .success{color:#53dd8a;font-weight:600}
    .row-actions button{padding:4px 10px;font-size:12px}
    .loading-inline{display:inline-block;width:16px;height:16px;border:3px solid rgba(255,255,255,.3);border-top-color:var(--accent);border-radius:50%;animation:spin .9s linear infinite;vertical-align:middle;margin-right:6px}
    @keyframes spin{to{transform:rotate(360deg)}}
    .flex-center{display:flex;align-items:center;gap:8px}
    .color-cell{display:flex;align-items:center;gap:6px}
    .pill{display:inline-block;padding:2px 8px;border-radius:12px;background:rgba(255,255,255,0.1);font-size:12px;margin-left:4px}
    .empty-hint{margin-top:16px;text-align:center;font-size:14px;color:var(--muted)}
    #tableWrap{overflow:visible;border:1px solid rgba(255,255,255,0.08);border-radius:10px;padding:4px;margin-top:12px;background:rgba(0,0,0,0.15);}
    #tableWrap table{margin:0}
    .footer-tip{margin-top:30px;font-size:12px;color:var(--muted);text-align:center}

    /* 使用說明 */
    details.help{margin:0 auto 12px;max-width:960px}
    details.help>summary{cursor:pointer;list-style:none;padding:10px 12px;border:1px solid rgba(255,255,255,0.08);border-radius:10px;background:rgba(255,255,255,0.04);font-weight:600;user-select:none}
    details.help[open]>summary{border-bottom-left-radius:0;border-bottom-right-radius:0}
    details.help .help-body{border:1px solid rgba(255,255,255,0.08);border-top:0;border-bottom-left-radius:10px;border-bottom-right-radius:10px;padding:10px 12px;background:rgba(255,255,255,0.02);font-size:13px;color:var(--muted)}
    details.help ul{margin:8px 0 0 18px}

    /* 響應式與可用性強化 */
    .top-row{gap:10px;flex-wrap:wrap}
    .top-row label{flex:1 1 420px}
    #scriptUrl{min-height:38px}
    .actions button{flex:0 1 auto}

    @media (max-width: 960px){
      body.admin-page{padding:16px}
      .admin-container{padding:18px}
    }

    @media (max-width: 640px){
      h1{font-size:20px}
      .page-subtitle{font-size:12px}
      .admin-container{padding:14px}
      .top-row{flex-direction:column}
      .top-row label{flex:1 1 auto;width:100%}
      .actions{flex-direction:column;position:sticky;bottom:0;background:linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.35) 16%, rgba(0,0,0,0.55) 100%);padding-bottom:env(safe-area-inset-bottom)}
      .actions button{width:100%}
      th,td{padding:8px}
      button{padding:12px 14px}
    }

  </style>
</head>
<body class="admin-page">
  <div class="admin-container">
    <h1>獎項後台管理</h1>
    <p class="page-subtitle">快速設定資料來源，新增或調整獎項，最後按下「儲存變更」。</p>
    <details class="help">
      <summary>使用說明與小提示</summary>
      <div class="help-body">
        <ul>
          <li>將 Google Apps Script 發佈的網址貼在欄位中後，按「重新載入」讀取最新資料。</li>
          <li>按「新增獎項」新增一列，編輯名稱、顏色、機率/權重等欄位。</li>
          <li>按「儲存變更」會覆蓋整張雲端工作表，請先確認內容正確。</li>
        </ul>
      </div>
    </details>

    <div class="flex-center top-row" role="group" aria-label="資料來源設定">
      <label>Apps Script URL
        <input id="scriptUrl" type="text" inputmode="url" enterkeyhint="go" placeholder="貼上 Google Apps Script 執行網址" aria-label="Google Apps Script 執行網址" value="https://script.google.com/macros/s/AKfycbzhhDithyIdajNRnZfUF468UgZhkkYTOxb88AsPF3lq-UU9V-QyFi7fOecO0YK1ImAP/exec" />
      </label>
      <button id="loadBtn" class="secondary" type="button" aria-label="重新載入資料">重新載入</button>
    </div>
    <div class="actions">
      <button id="addBtn" class="secondary" type="button">新增獎項</button>
      <button id="saveBtn" class="primary" type="button" disabled>儲存變更</button>
    </div>
    <div id="tableWrap"></div>
    <div id="status" class="status"></div>
    <div class="footer-tip">提示：空白顏色表示使用系統主題交替色。權重可為 0（會顯示但不會中獎）。儲存將覆蓋整張工作表。</div>
  </div>
  <script src="admin.js"></script>
</body>
</html>
