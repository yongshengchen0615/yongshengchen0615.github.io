<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“¢ğŸ‰ ç¶“çµ¡å·¥ç¨‹å¸« åˆ®åˆ®æ¨‚ | å…è²»æŒ‰æ‘©ç­‰ä½ ä¾†åˆ®ï¼ ğŸ‰ğŸ“¢</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #ffe5b4;
            font-family: "Microsoft JhengHei", "Arial", sans-serif;
            margin: 0;
            flex-direction: column;
        }

        .message {
            text-align: center;
            margin-bottom: 20px;
            font-size: 18px;
            color: #d9534f;
            padding: 10px;
        }

        .container {
            display: grid;
            grid-template-columns: repeat(2, minmax(120px, 1fr)); /* å…©åˆ—æ’åˆ— */
            gap: 15px;
            width: min(90vw, 350px);
        }

        .button {
            min-width: 120px;
            padding: 20px;
            font-size: 24px;
            color: white;
            background-color: #ff7f50;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.3s, transform 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.2);
            pointer-events: none;
            opacity: 0.5;
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ›è¡Œ */
        }

        .button.enabled {
            pointer-events: auto;
            opacity: 1;
        }

        .button:hover {
            background-color: #ff6347;
            transform: scale(1.05);
        }

        @media (max-width: 400px) {
            .container {
                grid-template-columns: repeat(1, 1fr); /* å°è¢å¹•è®Šå–®åˆ—æ’åˆ— */
            }
        }
    </style>
</head>
<body>
    <div class="message" id="message">æ­£åœ¨ç²å–æ‚¨çš„å®šä½...</div>
    <div class="container">
        <a href="./5points/index.html" class="button" id="btn5">5é»</a>
        <a href="./10points/index.html" class="button" id="btn10">10é»</a>
        <a href="./15points/index.html" class="button" id="btn15">15é»</a>
        <a href="./20points/index.html" class="button" id="btn20">20é»</a>
    </div>

    <script>
        // **æ‰‹å‹•è¼¸å…¥åº—å®¶ GPS ç¶“ç·¯åº¦**
        const storeLat = 22.989506830550127; // ä½ çš„åº—å®¶ç·¯åº¦
        const storeLon = 120.2055360995244; // ä½ çš„åº—å®¶ç¶“åº¦
        const allowedDistance = 0.1; // è¨­å®šå…è¨±ç¯„åœ (å…¬é‡Œ)ï¼Œ100 å…¬å°º = 0.1 å…¬é‡Œ

        function checkLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const userLat = position.coords.latitude;  // ä½¿ç”¨è€…ç·¯åº¦
                        const userLon = position.coords.longitude; // ä½¿ç”¨è€…ç¶“åº¦

                        console.log(`ä½¿ç”¨è€…ä½ç½®ï¼š${userLat}, ${userLon}`);

                        // è¨ˆç®—è·é›¢
                        const distance = getDistanceFromLatLon(userLat, userLon, storeLat, storeLon);

                        if (distance <= allowedDistance) {
                            document.getElementById("message").innerText = "âœ… ä½ç½®ç¢ºèªæˆåŠŸï¼æ‚¨å¯ä»¥åƒåŠ åˆ®åˆ®æ¨‚ï¼";
                            enableButtons();
                        } else {
                            document.getElementById("message").innerText = `âŒ ä½ç½®ä¸ç¬¦ï¼Œè«‹åˆ°åº—å…§åƒåŠ ï¼ï¼ˆè·é›¢ç´„ ${distance.toFixed(2)} å…¬é‡Œï¼‰`;
                        }
                    },
                    (error) => {
                        console.error("å®šä½éŒ¯èª¤ï¼š" + error.message);
                        document.getElementById("message").innerText = "âŒ ç²å–ä½ç½®å¤±æ•—ï¼Œè«‹å…è¨±å®šä½æ¬Šé™";
                    }
                );
            } else {
                document.getElementById("message").innerText = "âŒ ç€è¦½å™¨ä¸æ”¯æ´å®šä½åŠŸèƒ½";
            }
        }

        function enableButtons() {
            document.querySelectorAll(".button").forEach(btn => {
                btn.classList.add("enabled");
            });
        }

        // **å“ˆå¼—è³½å…¬å¼è¨ˆç®—å…©é»é–“è·é›¢ï¼ˆå…¬é‡Œï¼‰**
        function getDistanceFromLatLon(lat1, lon1, lat2, lon2) {
            const R = 6371; // åœ°çƒåŠå¾‘ï¼ˆå…¬é‡Œï¼‰
            const dLat = deg2rad(lat2 - lat1);
            const dLon = deg2rad(lon2 - lon1);
            const a =
                Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return R * c; // è½‰æ›æˆå…¬é‡Œ
        }

        function deg2rad(deg) {
            return deg * (Math.PI / 180);
        }

        checkLocation();
    </script>
</body>
</html>
